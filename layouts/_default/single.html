{{ define "main" }}
<article class="page-content">
    <header class="page-header">
        {{ if .Parent }}
        <h2 class="breadcrumb">
            {{ if .Parent.Parent }}
                <a href="{{ .Parent.Parent.RelPermalink }}">{{ .Parent.Parent.Section | title }}</a> › 
            {{ end }}
            <a href="{{ .Parent.RelPermalink }}">{{ .Parent.Title }}</a>
        </h2>
        {{ end }}
        <h1>{{ .Title }}</h1>
        <h2>{{ with .Params.author }}{{ . }} &middot;{{ end }} {{ with .Params.journal }}{{ if $.Params.external_url }}<a href="{{ $.Params.external_url }}" target="_blank" rel="noopener noreferrer"><cite>{{ . }}</cite> ↗</a>{{ else }}<cite>{{ . }}</cite>{{ end }} &middot;{{ end }}{{ if and .Params.volume .Params.issue }} {{ .Params.volume }}({{ .Params.issue }}) &middot;{{ end }}{{ with .Params.date }} <time datetime="{{ .Format "2006-01-02" }}">{{ .Format "2006" }}</time>{{ end }}{{ if and .Params.page_start .Params.page_end }}, pp. {{ .Params.page_start }}-{{ .Params.page_end }}{{ end }}</h2>
        {{ with .Params.description }}
        <h2>{{ . }}</h2>
        {{ end }}
    </header>
    
    <section class="publication-layout">
        <div class="content-body">
            {{ .Content }}
        </div>
        
        {{ if or .Params.cover_image .Params.first_page_image }}
        <div class="publication-images{{ if .Params.landscape }} landscape{{ end }}">
            {{ if .Params.cover_image }}
            <div class="cover-image">
                {{ if .Params.external_url }}
                <a href="{{ .Params.external_url }}" target="_blank" rel="noopener noreferrer">
                    {{ partial "image-processor.html" (dict "src" (printf "images/%s" .Params.cover_image) "alt" (printf "Cover image for %s" .Title)) }}
                </a>
                {{ else }}
                {{ partial "image-processor.html" (dict "src" (printf "images/%s" .Params.cover_image) "alt" (printf "Cover image for %s" .Title)) }}
                {{ end }}
            </div>
            {{ end }}
            {{ if .Params.first_page_image }}
            <div class="first-page-image">
                {{ if .Params.external_url }}
                <a href="{{ .Params.external_url }}" target="_blank" rel="noopener noreferrer">
                    {{ partial "image-processor.html" (dict "src" (printf "images/%s" .Params.first_page_image) "alt" (printf "First page of %s" .Title)) }}
                </a>
                {{ else }}
                {{ partial "image-processor.html" (dict "src" (printf "images/%s" .Params.first_page_image) "alt" (printf "First page of %s" .Title)) }}
                {{ end }}
            </div>
            {{ end }}
        </div>
        {{ end }}
    </section>
</article>
{{ end }}

{{ define "page-css" }}
    {{ $listCSS := resources.Get "css/list.css" | resources.Minify | resources.Fingerprint }}
    <link rel="stylesheet" href="{{ $listCSS.RelPermalink }}">
    {{ $pageCSS := resources.Get "css/research.css" | resources.Minify | resources.Fingerprint }}
    <link rel="stylesheet" href="{{ $pageCSS.RelPermalink }}">
{{ end }} 